from sklearn.neighbors import KDTree
import numpy as np

solution_params = [{'MT0': 32, 'MT1': 32, 'DepthU': 128},
 {'MT0': 32, 'MT1': 64, 'DepthU': 64},
 {'MT0': 32, 'MT1': 64, 'DepthU': 128},
 {'MT0': 32, 'MT1': 128, 'DepthU': 128},
 {'MT0': 32, 'MT1': 256, 'DepthU': 64},
 {'MT0': 64, 'MT1': 16, 'DepthU': 128},
 {'MT0': 64, 'MT1': 32, 'DepthU': 128},
 {'MT0': 64, 'MT1': 64, 'DepthU': 64},
 {'MT0': 64, 'MT1': 64, 'DepthU': 128},
 {'MT0': 64, 'MT1': 128, 'DepthU': 64},
 {'MT0': 64, 'MT1': 128, 'DepthU': 128},
 {'MT0': 128, 'MT1': 16, 'DepthU': 128},
 {'MT0': 128, 'MT1': 32, 'DepthU': 64},
 {'MT0': 128, 'MT1': 32, 'DepthU': 128},
 {'MT0': 128, 'MT1': 64, 'DepthU': 64},
 {'MT0': 128, 'MT1': 64, 'DepthU': 128},
 {'MT0': 128, 'MT1': 128, 'DepthU': 64},
 {'MT0': 128, 'MT1': 128, 'DepthU': 128},
 {'MT0': 256, 'MT1': 64, 'DepthU': 64}]

sizes = [{'m': 4096, 'n': 1024, 'k': 2048, 'SolutionIndex': 17},
 {'m': 2048, 'n': 512, 'k': 2048, 'SolutionIndex': 3},
 {'m': 2048, 'n': 8192, 'k': 2048, 'SolutionIndex': 17},
 {'m': 1024, 'n': 1024, 'k': 4096, 'SolutionIndex': 9},
 {'m': 512, 'n': 512, 'k': 2048, 'SolutionIndex': 0},
 {'m': 4096, 'n': 1024, 'k': 1024, 'SolutionIndex': 17},
 {'m': 1024, 'n': 8192, 'k': 2048, 'SolutionIndex': 18},
 {'m': 4096, 'n': 512, 'k': 8192, 'SolutionIndex': 10},
 {'m': 4096, 'n': 2048, 'k': 4096, 'SolutionIndex': 16},
 {'m': 1024, 'n': 2048, 'k': 1024, 'SolutionIndex': 15},
 {'m': 512, 'n': 4096, 'k': 2048, 'SolutionIndex': 14},
 {'m': 8192, 'n': 8192, 'k': 512, 'SolutionIndex': 17},
 {'m': 512, 'n': 512, 'k': 8192, 'SolutionIndex': 7},
 {'m': 2048, 'n': 1024, 'k': 512, 'SolutionIndex': 15},
 {'m': 512, 'n': 2048, 'k': 1024, 'SolutionIndex': 13},
 {'m': 4096, 'n': 512, 'k': 4096, 'SolutionIndex': 9},
 {'m': 4096, 'n': 2048, 'k': 8192, 'SolutionIndex': 16},
 {'m': 1024, 'n': 512, 'k': 4096, 'SolutionIndex': 7},
 {'m': 4096, 'n': 8192, 'k': 8192, 'SolutionIndex': 17},
 {'m': 2048, 'n': 4096, 'k': 2048, 'SolutionIndex': 16},
 {'m': 2048, 'n': 4096, 'k': 4096, 'SolutionIndex': 17},
 {'m': 1024, 'n': 8192, 'k': 512, 'SolutionIndex': 8},
 {'m': 1024, 'n': 8192, 'k': 1024, 'SolutionIndex': 7},
 {'m': 1024, 'n': 1024, 'k': 2048, 'SolutionIndex': 8},
 {'m': 512, 'n': 512, 'k': 1024, 'SolutionIndex': 5},
 {'m': 1024, 'n': 4096, 'k': 8192, 'SolutionIndex': 18},
 {'m': 2048, 'n': 8192, 'k': 4096, 'SolutionIndex': 16},
 {'m': 1024, 'n': 1024, 'k': 8192, 'SolutionIndex': 9},
 {'m': 1024, 'n': 2048, 'k': 4096, 'SolutionIndex': 14},
 {'m': 8192, 'n': 4096, 'k': 4096, 'SolutionIndex': 17},
 {'m': 1024, 'n': 4096, 'k': 2048, 'SolutionIndex': 14},
 {'m': 8192, 'n': 512, 'k': 512, 'SolutionIndex': 17},
 {'m': 1024, 'n': 512, 'k': 8192, 'SolutionIndex': 9},
 {'m': 8192, 'n': 512, 'k': 4096, 'SolutionIndex': 17},
 {'m': 4096, 'n': 2048, 'k': 512, 'SolutionIndex': 6},
 {'m': 4096, 'n': 2048, 'k': 1024, 'SolutionIndex': 7},
 {'m': 4096, 'n': 4096, 'k': 2048, 'SolutionIndex': 17},
 {'m': 8192, 'n': 4096, 'k': 8192, 'SolutionIndex': 17},
 {'m': 8192, 'n': 2048, 'k': 512, 'SolutionIndex': 8},
 {'m': 1024, 'n': 512, 'k': 1024, 'SolutionIndex': 6},
 {'m': 1024, 'n': 512, 'k': 2048, 'SolutionIndex': 2},
 {'m': 2048, 'n': 2048, 'k': 512, 'SolutionIndex': 17},
 {'m': 2048, 'n': 2048, 'k': 8192, 'SolutionIndex': 16},
 {'m': 8192, 'n': 1024, 'k': 512, 'SolutionIndex': 8},
 {'m': 4096, 'n': 8192, 'k': 2048, 'SolutionIndex': 17},
 {'m': 1024, 'n': 8192, 'k': 8192, 'SolutionIndex': 17},
 {'m': 2048, 'n': 1024, 'k': 8192, 'SolutionIndex': 16},
 {'m': 1024, 'n': 4096, 'k': 512, 'SolutionIndex': 17},
 {'m': 8192, 'n': 8192, 'k': 4096, 'SolutionIndex': 17},
 {'m': 8192, 'n': 4096, 'k': 2048, 'SolutionIndex': 17},
 {'m': 8192, 'n': 8192, 'k': 2048, 'SolutionIndex': 17},
 {'m': 1024, 'n': 2048, 'k': 512, 'SolutionIndex': 15},
 {'m': 4096, 'n': 1024, 'k': 4096, 'SolutionIndex': 16},
 {'m': 512, 'n': 2048, 'k': 2048, 'SolutionIndex': 13},
 {'m': 512, 'n': 512, 'k': 512, 'SolutionIndex': 5},
 {'m': 2048, 'n': 8192, 'k': 1024, 'SolutionIndex': 15},
 {'m': 512, 'n': 8192, 'k': 1024, 'SolutionIndex': 14},
 {'m': 1024, 'n': 2048, 'k': 8192, 'SolutionIndex': 16},
 {'m': 512, 'n': 1024, 'k': 8192, 'SolutionIndex': 14},
 {'m': 2048, 'n': 512, 'k': 512, 'SolutionIndex': 8},
 {'m': 8192, 'n': 4096, 'k': 1024, 'SolutionIndex': 17},
 {'m': 8192, 'n': 8192, 'k': 8192, 'SolutionIndex': 17},
 {'m': 2048, 'n': 1024, 'k': 2048, 'SolutionIndex': 9},
 {'m': 2048, 'n': 1024, 'k': 1024, 'SolutionIndex': 10},
 {'m': 512, 'n': 1024, 'k': 1024, 'SolutionIndex': 6},
 {'m': 2048, 'n': 4096, 'k': 8192, 'SolutionIndex': 16},
 {'m': 8192, 'n': 512, 'k': 1024, 'SolutionIndex': 6},
 {'m': 512, 'n': 2048, 'k': 4096, 'SolutionIndex': 12},
 {'m': 512, 'n': 8192, 'k': 8192, 'SolutionIndex': 17},
 {'m': 1024, 'n': 1024, 'k': 1024, 'SolutionIndex': 8},
 {'m': 4096, 'n': 4096, 'k': 4096, 'SolutionIndex': 17},
 {'m': 512, 'n': 4096, 'k': 512, 'SolutionIndex': 15},
 {'m': 4096, 'n': 512, 'k': 2048, 'SolutionIndex': 4},
 {'m': 512, 'n': 2048, 'k': 8192, 'SolutionIndex': 13},
 {'m': 512, 'n': 4096, 'k': 8192, 'SolutionIndex': 15},
 {'m': 4096, 'n': 4096, 'k': 512, 'SolutionIndex': 6},
 {'m': 8192, 'n': 1024, 'k': 1024, 'SolutionIndex': 8},
 {'m': 8192, 'n': 2048, 'k': 4096, 'SolutionIndex': 17},
 {'m': 2048, 'n': 512, 'k': 1024, 'SolutionIndex': 3},
 {'m': 512, 'n': 512, 'k': 4096, 'SolutionIndex': 1},
 {'m': 8192, 'n': 4096, 'k': 512, 'SolutionIndex': 15},
 {'m': 8192, 'n': 512, 'k': 2048, 'SolutionIndex': 16},
 {'m': 8192, 'n': 8192, 'k': 1024, 'SolutionIndex': 17},
 {'m': 512, 'n': 1024, 'k': 512, 'SolutionIndex': 11},
 {'m': 8192, 'n': 1024, 'k': 2048, 'SolutionIndex': 16},
 {'m': 2048, 'n': 1024, 'k': 4096, 'SolutionIndex': 9},
 {'m': 4096, 'n': 2048, 'k': 2048, 'SolutionIndex': 16},
 {'m': 2048, 'n': 2048, 'k': 2048, 'SolutionIndex': 14},
 {'m': 2048, 'n': 512, 'k': 4096, 'SolutionIndex': 3},
 {'m': 4096, 'n': 8192, 'k': 1024, 'SolutionIndex': 17},
 {'m': 1024, 'n': 2048, 'k': 2048, 'SolutionIndex': 15},
 {'m': 8192, 'n': 2048, 'k': 8192, 'SolutionIndex': 17},
 {'m': 2048, 'n': 4096, 'k': 512, 'SolutionIndex': 8},
 {'m': 512, 'n': 8192, 'k': 2048, 'SolutionIndex': 16},
 {'m': 512, 'n': 1024, 'k': 4096, 'SolutionIndex': 8},
 {'m': 2048, 'n': 8192, 'k': 8192, 'SolutionIndex': 17},
 {'m': 512, 'n': 2048, 'k': 512, 'SolutionIndex': 13},
 {'m': 4096, 'n': 8192, 'k': 4096, 'SolutionIndex': 17},
 {'m': 8192, 'n': 1024, 'k': 8192, 'SolutionIndex': 17},
 {'m': 8192, 'n': 2048, 'k': 2048, 'SolutionIndex': 15},
 {'m': 1024, 'n': 4096, 'k': 1024, 'SolutionIndex': 17},
 {'m': 2048, 'n': 8192, 'k': 512, 'SolutionIndex': 14},
 {'m': 4096, 'n': 8192, 'k': 512, 'SolutionIndex': 17},
 {'m': 4096, 'n': 512, 'k': 512, 'SolutionIndex': 15},
 {'m': 512, 'n': 4096, 'k': 1024, 'SolutionIndex': 14},
 {'m': 8192, 'n': 512, 'k': 8192, 'SolutionIndex': 16},
 {'m': 4096, 'n': 1024, 'k': 512, 'SolutionIndex': 17},
 {'m': 8192, 'n': 2048, 'k': 1024, 'SolutionIndex': 15},
 {'m': 1024, 'n': 512, 'k': 512, 'SolutionIndex': 11},
 {'m': 2048, 'n': 2048, 'k': 1024, 'SolutionIndex': 17},
 {'m': 1024, 'n': 8192, 'k': 4096, 'SolutionIndex': 17},
 {'m': 512, 'n': 8192, 'k': 512, 'SolutionIndex': 17},
 {'m': 4096, 'n': 4096, 'k': 8192, 'SolutionIndex': 17},
 {'m': 4096, 'n': 4096, 'k': 1024, 'SolutionIndex': 10},
 {'m': 1024, 'n': 1024, 'k': 512, 'SolutionIndex': 8},
 {'m': 512, 'n': 1024, 'k': 2048, 'SolutionIndex': 11},
 {'m': 8192, 'n': 1024, 'k': 4096, 'SolutionIndex': 17},
 {'m': 2048, 'n': 512, 'k': 8192, 'SolutionIndex': 9},
 {'m': 4096, 'n': 1024, 'k': 8192, 'SolutionIndex': 16},
 {'m': 512, 'n': 8192, 'k': 4096, 'SolutionIndex': 17},
 {'m': 512, 'n': 4096, 'k': 4096, 'SolutionIndex': 15},
 {'m': 2048, 'n': 4096, 'k': 1024, 'SolutionIndex': 7},
 {'m': 4096, 'n': 512, 'k': 1024, 'SolutionIndex': 10},
 {'m': 1024, 'n': 4096, 'k': 4096, 'SolutionIndex': 18},
 {'m': 2048, 'n': 2048, 'k': 4096, 'SolutionIndex': 16}]

searchpoints = np.array([(tsol['m'], tsol['n'], tsol['k']) for tsol in sizes])
tunedtree = KDTree(searchpoints)
tunedarr = np.array([tsol['SolutionIndex'] for tsol in sizes])
